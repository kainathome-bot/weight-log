<!doctype html>
<html lang="ja">

<head>
  <meta charset="UTF-8" />
  <link rel="icon" type="image/svg+xml" href="/vite.svg" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
  <meta name="theme-color" content="#e0f7fa" id="theme-color-meta">
  <title>体重ログ</title>
  <link rel="stylesheet" href="/src/style.css">
</head>

<body class="mode-morning">
  <div id="app">
    <header>
      <h1 id="app-title">朝の記録</h1>
      <div id="date-display">
        <input type="date" id="date-input">
      </div>
    </header>

    <div class="glass-card mode-toggle">
      <button class="mode-btn active" id="btn-mode-morning">朝</button>
      <button class="mode-btn" id="btn-mode-night">夜</button>
    </div>

    <main class="glass-card">
      <div class="input-group" id="weight-group">
        <label for="weight-input">体重（kg）</label>
        <input type="number" id="weight-input" step="0.1" inputmode="decimal" placeholder="例：75.3">
      </div>

      <div class="input-group hidden" id="calorie-group">
        <label for="calorie-input">総カロリー（kcal）</label>
        <input type="number" id="calorie-input" step="1" inputmode="numeric" placeholder="例：2200">
      </div>
    </main>

    <div class="bottom-actions">
      <div class="action-row-main">
        <button id="action-btn" class="btn-primary">体重を記録</button>
      </div>
      <div class="action-row-sub">
        <button id="export-btn" class="btn-secondary">CSV出力</button>
        <button id="report-link-btn" class="btn-secondary">スマホで確認</button>
        <button id="graph-btn" class="btn-secondary">グラフ</button>
      </div>
    </div>

  </div>

  <!-- Report View (Overlay) -->
  <div id="report-view" class="glass-card hidden"
    style="position: absolute; top:0; left:0; width:100%; height:100%; z-index: 100; margin:0; border-radius: 0; overflow-y: auto; display: flex; flex-direction: column;">
    <header style="margin-bottom: 20px; flex-shrink: 0;">
      <h2 style="font-size: 1.2rem; font-weight: 700;">記録の確認</h2>
      <div class="range-controls">
        <div class="range-row">
          <label class="range-label">開始日
            <input type="date" id="report-start-date" class="range-input">
          </label>
          <div class="range-sep">〜</div>
          <label class="range-label">終了日
            <input type="date" id="report-end-date" class="range-input">
          </label>
        </div>

        <div class="quick-row">
          <button id="report-q-1w" class="quick-btn">1週間</button>
          <button id="report-q-1m" class="quick-btn">1か月</button>
          <button id="report-q-3m" class="quick-btn">3か月</button>
          <button id="report-q-1y" class="quick-btn">1年</button>
        </div>

        <button id="report-update-btn" class="btn-secondary" style="width:100%">表示</button>
      </div>
    </header>

    <!-- Summary Cards -->
    <div id="summary-container"
      style="display: flex; gap: 10px; margin-bottom: 20px; flex-shrink: 0; overflow-x: auto; padding-bottom: 5px;">
      <div class="glass-card" style="flex: 1; padding: 15px; min-width: 140px; margin-bottom: 0;">
        <h3 style="font-size: 0.8rem; opacity: 0.8;">体重 (kg)</h3>
        <div id="summary-weight" style="font-size: 0.9rem; margin-top: 5px;">-</div>
      </div>
      <div class="glass-card" style="flex: 1; padding: 15px; min-width: 140px; margin-bottom: 0;">
        <h3 style="font-size: 0.8rem; opacity: 0.8;">カロリー (kcal)</h3>
        <div id="summary-calorie" style="font-size: 0.9rem; margin-top: 5px;">-</div>
      </div>
    </div>

    <div style="flex: 1; overflow-y: auto; margin-bottom: 20px;">
      <table style="width: 100%; border-collapse: collapse; font-size: 0.9rem;">
        <thead style="position: sticky; top: 0; background: rgba(255,255,255,0.9); backdrop-filter: blur(5px);">
          <tr>
            <th style="text-align: left; padding: 10px; border-bottom: 1px solid rgba(0,0,0,0.1);">日付</th>
            <th style="text-align: right; padding: 10px; border-bottom: 1px solid rgba(0,0,0,0.1);">体重</th>
            <th style="text-align: right; padding: 10px; border-bottom: 1px solid rgba(0,0,0,0.1);">前日差</th>
          </tr>
        </thead>
        <tbody id="report-table-body">
          <!-- Rows injected here -->
        </tbody>
      </table>
    </div>

    <button id="report-back-btn"
      style="padding: 15px; background: rgba(0,0,0,0.1); border:none; border-radius: var(--radius-md); font-weight: bold; flex-shrink: 0;">戻る</button>
  </div>

  <!-- Graph View -->
  <div id="graph-view" class="glass-card hidden" style="max-width: 480px; margin: 0 auto; padding: 20px; height: 100vh; display:flex; flex-direction:column;">
    <header class="range-header">
      <h1 style="font-size: 1.3rem; margin: 0 0 8px 0;">グラフ</h1>

      <div class="range-controls">
        <div class="range-dates">
          <label class="range-label">開始日
            <input id="graph-start" type="date" class="range-input" />
          </label>
          <div class="range-sep">〜</div>
          <label class="range-label">終了日
            <input id="graph-end" type="date" class="range-input" />
          </label>
          <button id="graph-update-btn" class="range-show">表示</button>
        </div>

        <div class="quick-range" aria-label="クイック選択">
          <button class="quick-btn" data-range="7">1週間</button>
          <button class="quick-btn" data-range="30">1か月</button>
          <button class="quick-btn" data-range="90">3か月</button>
          <button class="quick-btn" data-range="365">1年</button>
        </div>

        <div class="metric-tabs">
          <button id="metric-weight" class="tab-btn is-active" data-metric="weight">体重</button>
          <button id="metric-calorie" class="tab-btn" data-metric="calorie">カロリー</button>
        </div>
      </div>
    </header>

    <div class="chart-wrap">
      <canvas id="graph-canvas"></canvas>
    </div>

    <button id="graph-back-btn" style="padding: 15px; background: rgba(0,0,0,0.1); border:none; border-radius: var(--radius-md); font-weight: bold; flex-shrink: 0;">戻る</button>
  </div>

  <script type="module" src="/src/main.js"></script>
</body>

</html>